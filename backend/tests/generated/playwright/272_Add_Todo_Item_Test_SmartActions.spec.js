/**
 * Test: Add Todo Item Test
 * ðŸ”§ Runtime Self-Healing: This test uses smart actions with Vision fallback
 *
 * Generated by Nexus QA Platform
 * Date: 2025-12-24
 */

import { test, expect } from '@playwright/test';
import { smartClick, smartFill, smartWaitFor } from '../../helpers/smartActions.js';

test('Add Todo Item Test - With Smart Actions', async ({ page }) => {
  console.log('[Test] Starting: Add Todo Item Test');

  // Step 1: Navigate to TodoMVC
  console.log('[Test] Step 1: Navigating to TodoMVC...');
  await page.goto('https://demo.playwright.dev/todomvc');
  await page.waitForLoadState('domcontentloaded');
  await page.screenshot({ path: 'screenshots/step1-navigate.png' }).catch(() => {});

  // Step 2: Fill todo input with smart fill (Vision fallback)
  console.log('[Test] Step 2: Filling todo input with "Buy groceries"...');
  const fillResult = await smartFill(page, 'input.new-todo', 'Buy groceries', { retryWithVision: true });
  console.log('[Test] Fill result:', fillResult);
  await page.screenshot({ path: 'screenshots/step2-filled.png' }).catch(() => {});

  // Step 3: Press Enter to add the todo
  console.log('[Test] Step 3: Pressing Enter to add todo...');
  await page.keyboard.press('Enter');
  await page.waitForTimeout(1000);
  await page.screenshot({ path: 'screenshots/step3-added.png' }).catch(() => {});

  // Verify: Todo item should be visible in the list
  console.log('[Test] Verifying: Todo item is visible...');
  const todoText = await page.locator('.todo-list li').first().textContent();
  console.log('[Test] Todo text found:', todoText);

  expect(todoText).toContain('Buy groceries');
  console.log('[Test] âœ… Test passed!');
});
